<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Real Estate Financial Modeling Platform</title>

<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

<style>
body { font-family: 'Inter', sans-serif; }
.tab-active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
.module-card { background: white; border-radius: 16px; box-shadow: 0 4px 6px rgba(0,0,0,0.07); transition: 0.3s; }
.module-card:hover { box-shadow: 0 10px 20px rgba(0,0,0,0.12); transform: translateY(-2px); }
.gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
.btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); transition: 0.3s; }
.btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(102,126,234,0.4); }
.notification { position: fixed; top:20px; right:20px; padding:12px 20px; border-radius:8px; color:white; font-weight:600; z-index:1000;}
.modal-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.5); display:flex; align-items:center; justify-content:center; z-index:50;}
</style>
</head>

<body class="bg-gray-50">
<div id="root"></div>

<script type="text/babel">

const { useState, useEffect } = React;

function RealEstatePlatform(){

/* ===================== SAVE / LOAD STATES ===================== */
const [notification,setNotification]=useState(null);
const [showSaveModal,setShowSaveModal]=useState(false);
const [showLoadModal,setShowLoadModal]=useState(false);
const [savedProjects,setSavedProjects]=useState([]);
const [saveProjectName,setSaveProjectName]=useState("");

/* ===================== ORIGINAL STATES (UNCHANGED) ===================== */
const [activeModule,setActiveModule]=useState('overview');
const [activeTab,setActiveTab]=useState('timeline');

const [projectName,setProjectName]=useState('Skyline Mixed-Use Development');
const [projectStart,setProjectStart]=useState('2025-01-01');
const [preConstructionMonths,setPreConstructionMonths]=useState(6);
const [constructionMonths,setConstructionMonths]=useState(24);
const [operationsMonths,setOperationsMonths]=useState(60);

const [landAcquisitionType,setLandAcquisitionType]=useState('cash');
const [landValue,setLandValue]=useState(50000000);
const [totalLandArea,setTotalLandArea]=useState(100000);
const [gfa,setGfa]=useState(150000);
const [bua,setBua]=useState(120000);
const [residentialArea,setResidentialArea]=useState(60000);
const [hospitalityArea,setHospitalityArea]=useState(30000);
const [retailArea,setRetailArea]=useState(30000);

const [devCosts,setDevCosts]=useState([...]);   // KEEP YOUR FULL ARRAY HERE
const [debtPercentage,setDebtPercentage]=useState(60);
const [interestRate,setInterestRate]=useState(7.5);
const [debtDrawdownStart,setDebtDrawdownStart]=useState(7);
const [interestCapitalized,setInterestCapitalized]=useState(true);
const [investors,setInvestors]=useState([...]); // KEEP YOUR FULL ARRAY HERE


/* ===================== SAVE / LOAD LOGIC ===================== */

const getProjectData=()=>({
projectName,projectStart,preConstructionMonths,constructionMonths,operationsMonths,
landAcquisitionType,landValue,totalLandArea,gfa,bua,residentialArea,hospitalityArea,retailArea,
devCosts,debtPercentage,interestRate,debtDrawdownStart,interestCapitalized,investors
});

const loadSavedProjectsList=()=>{
const saved=localStorage.getItem("realestate_projects");
if(saved){ setSavedProjects(JSON.parse(saved)); }
};

useEffect(()=>{ loadSavedProjectsList(); },[]);

useEffect(()=>{
const interval=setInterval(()=>{
localStorage.setItem("realestate_autosave",JSON.stringify(getProjectData()));
},30000);
return()=>clearInterval(interval);
});

const saveProject=()=>{
const name=saveProjectName||projectName;
const project={
id:Date.now().toString(),
name,
timestamp:new Date().toISOString(),
data:getProjectData()
};
const updated=[...savedProjects.filter(p=>p.name!==name),project];
localStorage.setItem("realestate_projects",JSON.stringify(updated));
setSavedProjects(updated);
setShowSaveModal(false);
setSaveProjectName("");
showNotification("âœ“ Project Saved","green");
};

const loadProject=(p)=>{
const d=p.data;
Object.entries(d).forEach(([key,val])=>{
if(eval(`typeof ${key} !== "undefined"`)){
eval(`set${key.charAt(0).toUpperCase()+key.slice(1)}(val)`);
}
});
setShowLoadModal(false);
showNotification("âœ“ Project Loaded","green");
};

const deleteProject=(id)=>{
const updated=savedProjects.filter(p=>p.id!==id);
localStorage.setItem("realestate_projects",JSON.stringify(updated));
setSavedProjects(updated);
};

const exportProject=()=>{
const blob=new Blob([JSON.stringify(getProjectData(),null,2)],{type:'application/json'});
const url=URL.createObjectURL(blob);
const a=document.createElement("a");
a.href=url;
a.download=`${projectName}.json`;
a.click();
};

const importProject=(e)=>{
const file=e.target.files[0];
const reader=new FileReader();
reader.onload=(ev)=>{
const data=JSON.parse(ev.target.result);
loadProject({data});
};
reader.readAsText(file);
};

const showNotification=(msg,color)=>{
setNotification({msg,color});
setTimeout(()=>setNotification(null),3000);
};

/* ===================== YOUR ORIGINAL CALCULATIONS ===================== */
// (ALL YOUR CALCULATIONS REMAIN SAME HERE)

/* ===================== UI ===================== */

return(
<div>

{/* Notification */}
{notification&&(
<div className={`notification bg-${notification.color}-600`}>
{notification.msg}
</div>
)}

{/* Header with Save Buttons */}
<div className="gradient-bg text-white py-6 px-6 shadow-lg">
<div className="max-w-7xl mx-auto flex justify-between items-center">
<div>
<h1 className="text-3xl font-bold">Real Estate Financial Modeling Platform</h1>
</div>
<div className="flex gap-2">
<button onClick={()=>setShowSaveModal(true)} className="bg-green-600 px-4 py-2 rounded">ðŸ’¾ Save</button>
<button onClick={()=>setShowLoadModal(true)} className="bg-blue-600 px-4 py-2 rounded">ðŸ“‚ Load</button>
<button onClick={exportProject} className="bg-purple-600 px-4 py-2 rounded">ðŸ“¥ Export</button>
<label className="bg-indigo-600 px-4 py-2 rounded cursor-pointer">
ðŸ“¤ Import
<input type="file" accept=".json" onChange={importProject} className="hidden"/>
</label>
</div>
</div>
</div>

{/* ===== YOUR ENTIRE ORIGINAL UI CONTINUES HERE UNCHANGED ===== */}

</div>
);
}

ReactDOM.render(<RealEstatePlatform/>,document.getElementById('root'));
</script>
</body>
</html>
